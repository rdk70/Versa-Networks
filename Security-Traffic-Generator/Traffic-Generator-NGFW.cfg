devices {
    template Traffic-Generator-NGFW {
        config {
            /* Tags: replace */
            orgs {
                org <Org Name> {
                    appliance-owner;
                    services        [ nextgen-firewall ];
                }
                org-services <Org Name> {
                    application-identification {
                        user-defined-applications {
                            user-defined-application TG-ATP-Predefined-URLS {
                                description   "#Eicar";
                                family        networking;
                                subfamily     security-service;
                                productivity  1;
                                risk          5;
                                tag           [ vs_malware ];
                                precedence    100;
                                app-match-ips false;
                                app-match-rules secure-eicar-org-eicar-com-txt {
                                    host-pattern secure.eicar.org/eicar.com.txt;
                                }
                            }
                            user-defined-application TG-Vulnerabilit-Predefined-URLS {
                                description   "#Vulnerability";
                                family        networking;
                                subfamily     antivirus;
                                productivity  1;
                                risk          5;
                                tag           [ vs_vulnerable ];
                                precedence    100;
                                app-match-ips false;
                                app-match-rules http-evader-semantic-gap {
                                    host-pattern http://http-evader.semantic-gap.de;
                                }
                                app-match-rules 37-221-199-196 {
                                    host-pattern 37.221.199.196;
                                }
                                app-match-rules testmyids-com {
                                    host-pattern testmyids.com;
                                }
                            }
                            user-defined-application TG-AntiVirus-Scan-URLS {
                                description   "#AV";
                                family        networking;
                                subfamily     terminal;
                                productivity  1;
                                risk          5;
                                tag           [ vs_vulnerable ];
                                precedence    103;
                                app-match-ips false;
                                app-match-rules eicar-org-download-anti-malware {
                                    host-pattern www.eicar.org/download-anti-malware-testfile;
                                }
                                app-match-rules secure-eicar-org-eicar_com-zip {
                                    host-pattern secure.eicar.org/eicar_com.zip;
                                }
                                app-match-rules http-evader-semantic-gap-de {
                                    host-pattern http-evader.semantic-gap.de/-BGJhmNoDFOy1TQD0tk0P96wLE-2pTBXgrg;
                                }
                            }
                            user-defined-application TG-File-Filter-URLS {
                                description   "#File-Filters";
                                family        business-system;
                                subfamily     antivirus;
                                productivity  1;
                                risk          5;
                                tag           [ vs_vulnerable ];
                                precedence    104;
                                app-match-ips false;
                                app-match-rules Github {
                                    host-pattern Github.com;
                                }
                                app-match-rules Versa-Box {
                                    host-pattern versanetworksbox.com;
                                }
                            }
                            user-defined-application TG-DNS-Filter-URLS {
                                description   "#DNS-Filter";
                                family        networking;
                                subfamily     network-management;
                                productivity  1;
                                risk          5;
                                tag           [ vs_vulnerable ];
                                precedence    106;
                                app-match-ips false;
                                app-match-rules TG-Gitlab {
                                    host-pattern gitlab.com;
                                }
                                app-match-rules deezer-com {
                                    host-pattern deezer.com;
                                }
                            }
                        }
                    }
                    security {
                        profiles {
                            av {
                                av-profile TG-AntiVirus-Scan-Zip-Files {
                                    lef-profile-default true;
                                    file-type           [ 7zip zip ];
                                    direction           both;
                                    action              recommended-action;
                                    action-on-disk-full deny;
                                    protocol            [ HTTP ];
                                }
                            }
                            dos {
                                aggregate {
                                    dos-profile Aggregate-Prof {
                                        flood {
                                            icmp {
                                                enable yes;
                                                red {
                                                    activate-rate 70;
                                                    alarm-rate    60;
                                                    maximal-rate  80;
                                                    drop-period   5;
                                                }
                                            }
                                            icmpv6 {
                                                enable no;
                                                red {
                                                    activate-rate 100000;
                                                    alarm-rate    100000;
                                                    maximal-rate  100000;
                                                    drop-period   300;
                                                }
                                            }
                                            other-ip {
                                                enable yes;
                                                red {
                                                    activate-rate 400;
                                                    alarm-rate    300;
                                                    maximal-rate  500;
                                                    drop-period   5;
                                                }
                                            }
                                            tcp {
                                                enable yes;
                                                action random-early-drop;
                                                red {
                                                    activate-rate 400;
                                                    alarm-rate    300;
                                                    maximal-rate  500;
                                                    drop-period   5;
                                                }
                                            }
                                            udp {
                                                enable yes;
                                                red {
                                                    activate-rate 400;
                                                    alarm-rate    300;
                                                    maximal-rate  500;
                                                    drop-period   5;
                                                }
                                            }
                                            sctp {
                                                enable yes;
                                                red {
                                                    activate-rate 400;
                                                    alarm-rate    300;
                                                    maximal-rate  500;
                                                    drop-period   5;
                                                }
                                            }
                                        }
                                    }
                                }
                                classified {
                                    dos-profile Classified-Prof {
                                        flood {
                                            icmp {
                                                enable yes;
                                                red {
                                                    activate-rate 70;
                                                    alarm-rate    60;
                                                    maximal-rate  80;
                                                    drop-period   5;
                                                }
                                            }
                                            icmpv6 {
                                                enable no;
                                                red {
                                                    activate-rate 100000;
                                                    alarm-rate    100000;
                                                    maximal-rate  100000;
                                                    drop-period   300;
                                                }
                                            }
                                            other-ip {
                                                enable yes;
                                                red {
                                                    activate-rate 400;
                                                    alarm-rate    300;
                                                    maximal-rate  500;
                                                    drop-period   5;
                                                }
                                            }
                                            tcp {
                                                enable yes;
                                                action random-early-drop;
                                                red {
                                                    activate-rate 400;
                                                    alarm-rate    300;
                                                    maximal-rate  500;
                                                    drop-period   5;
                                                }
                                            }
                                            udp {
                                                enable yes;
                                                red {
                                                    activate-rate 400;
                                                    alarm-rate    300;
                                                    maximal-rate  500;
                                                    drop-period   5;
                                                }
                                            }
                                            sctp {
                                                enable yes;
                                                red {
                                                    activate-rate 400;
                                                    alarm-rate    300;
                                                    maximal-rate  500;
                                                    drop-period   5;
                                                }
                                            }
                                        }
                                        classification-key destination-ip-only;
                                    }
                                }
                            }
                            url-filtering {
                                url-filtering-profile TG-URL-Filter-Block {
                                    cloud-lookup        enabled;
                                    lef-profile-default true;
                                    decrypt-bypass      false;
                                    default-action {
                                        predefined allow;
                                    }
                                    blacklist {
                                        patterns          [ .*monster.* ];
                                        evaluate-referrer true;
                                        action {
                                            predefined block;
                                        }
                                    }
                                    whitelist {
                                        patterns          [ .*amazon.* ];
                                        log-enable        true;
                                        evaluate-referrer true;
                                    }
                                    category-action-map {
                                        category-action Shopping {
                                            url-categories {
                                                predefined [ shopping ];
                                            }
                                            action {
                                                predefined ask;
                                            }
                                        }
                                        category-action SocialNetwork {
                                            url-categories {
                                                predefined [ social_network ];
                                            }
                                            action {
                                                predefined justify;
                                            }
                                        }
                                        category-action Block_Sites {
                                            url-categories {
                                                predefined [ auctions dating gambling hacking peer_to_peer proxy_avoid_and_anonymizers weapons adult_and_pornography alcohol_and_tobacco abortion abused_drugs bot_nets illegal sex_education games malware_sites nudity violence ];
                                            }
                                            action {
                                                predefined block;
                                            }
                                        }
                                        category-action Job_Search {
                                            url-categories {
                                                predefined [ job_search ];
                                            }
                                            action {
                                                predefined allow;
                                            }
                                        }
                                    }
                                    reputation-action-map {
                                        reputation-action Moderate_Risk {
                                            url-reputations {
                                                predefined [ moderate_risk ];
                                            }
                                            action {
                                                predefined alert;
                                            }
                                        }
                                    }
                                }
                            }
                            predefined-ips-profile-overrides {
                                predefined-ips-profile-override Reject-Predefined-Vulnerability {
                                    rule {
                                        packet-capture {
                                            pre-window  1;
                                            post-window 1;
                                            enable      false;
                                        }
                                        action {
                                            predefined reject;
                                        }
                                    }
                                    lef-profile-default true;
                                }
                            }
                            ip-filtering {
                                ip-filter-profile TG-Bad-IP-Filter {
                                    black-list {
                                        ip-addresses {
                                            address-groups [ TG-Bad-Events ];
                                        }
                                        match source-or-destination;
                                        action {
                                            predefined [ block ];
                                        }
                                    }
                                    white-list {
                                        log false;
                                    }
                                    default-action {
                                        predefined [ allow ];
                                    }
                                    lef-profile-default       true;
                                    address-reverse-lookup {
                                        enable false;
                                    }
                                    prioritize-url-reputation enabled;
                                    allow-url-reputation      trustworthy;
                                }
                            }
                            file-filtering {
                                filefilter-profile TG-File-Filter-Profile {
                                    lef-profile-default true;
                                    protocol            [ HTTP FTP ];
                                    file-decompression {
                                        decompression enabled;
                                        max-level     1;
                                        limit-reach-action {
                                            action block;
                                        }
                                    }
                                    default-action {
                                        action block;
                                    }
                                    blacklist {
                                        sha384    [ 71A2D129714CE631956898C2A8ACC6D552908C172ABC6F0DB8200F0F54B7DADA1355D4FDDF993095390748A9AB9A1EF2 052DBEEA0E44BF6B48DC2A7FAC9A6212FEDB60EC3DC7A778EB96BAD779F1CB80D9B2F8992B4A750E839C9D301167A8BA 431DB4FB98A752BE083D607FADC5E85B7ACA999918435B2E76A65891DBAFF08C0540A1F339F2DC74AF20E76B109D4343 ];
                                        sha256    [ C25543DE57B1BF28D8CBD91F74CD45E0C378E84BF83A4B43E6D49FAD3E08EAD9 3D18A2C832AF2F28C5C6D4278C923C5CDD436EACE5E46115051F2ADDA4EFCFD1 FAE1C0177ED9160862515C853534C2725E7CCD437403EFC44AFABC8BEE779ADB ];
                                        lookup    enabled;
                                        bl-action block;
                                        logging   enabled;
                                    }
                                    whitelist {
                                        lookup  disabled;
                                        logging disabled;
                                    }
                                    reputation {
                                        lookup           disabled;
                                        private-ip-check disabled;
                                        action           allow;
                                        logging          disabled;
                                    }
                                }
                            }
                            zone-protection {
                                zone-protection-profile ZP_profile {
                                    flood {
                                        icmp {
                                            enable yes;
                                            red {
                                                activate-rate 70;
                                                alarm-rate    60;
                                                maximal-rate  80;
                                                drop-period   5;
                                            }
                                        }
                                        icmpv6 {
                                            enable no;
                                            red {
                                                activate-rate 400;
                                                alarm-rate    300;
                                                maximal-rate  500;
                                                drop-period   5;
                                            }
                                        }
                                        other-ip {
                                            enable yes;
                                            red {
                                                activate-rate 400;
                                                alarm-rate    300;
                                                maximal-rate  500;
                                                drop-period   5;
                                            }
                                        }
                                        tcp {
                                            enable yes;
                                            action random-early-drop;
                                            red {
                                                activate-rate 400;
                                                alarm-rate    300;
                                                maximal-rate  500;
                                                drop-period   5;
                                            }
                                        }
                                        udp {
                                            enable yes;
                                            red {
                                                activate-rate 400;
                                                alarm-rate    300;
                                                maximal-rate  500;
                                                drop-period   5;
                                            }
                                        }
                                        sctp {
                                            enable yes;
                                            red {
                                                activate-rate 400;
                                                alarm-rate    300;
                                                maximal-rate  500;
                                                drop-period   5;
                                            }
                                        }
                                    }
                                    scan {
                                        tcp {
                                            enable    yes;
                                            action    alert;
                                            interval  30;
                                            threshold 3;
                                        }
                                        udp {
                                            enable    yes;
                                            action    alert;
                                            interval  30;
                                            threshold 3;
                                        }
                                        hostsweep {
                                            enable    yes;
                                            action    alert;
                                            interval  30;
                                            threshold 3;
                                        }
                                    }
                                    tcp {
                                        reject-non-syn yes;
                                    }
                                    udp {
                                        discard-malformed yes;
                                    }
                                    ip {
                                        discard-ip-spoof              yes;
                                        discard-ip-frag               yes;
                                        discard-strict-source-routing yes;
                                        discard-loose-source-routing  yes;
                                        discard-timestamp             yes;
                                        discard-record-route          yes;
                                        discard-security              yes;
                                        discard-stream                yes;
                                        discard-unknown               yes;
                                        discard-malformed             yes;
                                    }
                                    icmp {
                                        discard-frag           yes;
                                        discard-error-messages yes;
                                        discard-large-packet   yes;
                                        discard-ping-zero-id   yes;
                                        discard-malformed      yes;
                                    }
                                }
                                zone-protection-profile TG-ZP-profile {
                                    flood {
                                        icmp {
                                            enable yes;
                                            red {
                                                activate-rate 70;
                                                alarm-rate    60;
                                                maximal-rate  80;
                                                drop-period   5;
                                            }
                                        }
                                        icmpv6 {
                                            enable no;
                                            red {
                                                activate-rate 400;
                                                alarm-rate    300;
                                                maximal-rate  500;
                                                drop-period   5;
                                            }
                                        }
                                        other-ip {
                                            enable yes;
                                            red {
                                                activate-rate 400;
                                                alarm-rate    300;
                                                maximal-rate  500;
                                                drop-period   5;
                                            }
                                        }
                                        tcp {
                                            enable yes;
                                            action random-early-drop;
                                            red {
                                                activate-rate 400;
                                                alarm-rate    300;
                                                maximal-rate  500;
                                                drop-period   5;
                                            }
                                        }
                                        udp {
                                            enable yes;
                                            red {
                                                activate-rate 400;
                                                alarm-rate    300;
                                                maximal-rate  500;
                                                drop-period   5;
                                            }
                                        }
                                        sctp {
                                            enable yes;
                                            red {
                                                activate-rate 400;
                                                alarm-rate    300;
                                                maximal-rate  500;
                                                drop-period   5;
                                            }
                                        }
                                    }
                                    scan {
                                        tcp {
                                            enable    yes;
                                            action    alert;
                                            interval  30;
                                            threshold 3;
                                        }
                                        udp {
                                            enable    yes;
                                            action    alert;
                                            interval  30;
                                            threshold 3;
                                        }
                                        hostsweep {
                                            enable    yes;
                                            action    alert;
                                            interval  30;
                                            threshold 3;
                                        }
                                    }
                                    tcp {
                                        reject-non-syn yes;
                                    }
                                    udp {
                                        discard-malformed yes;
                                    }
                                    ip {
                                        discard-ip-spoof              yes;
                                        discard-ip-frag               yes;
                                        discard-strict-source-routing yes;
                                        discard-loose-source-routing  yes;
                                        discard-timestamp             yes;
                                        discard-record-route          yes;
                                        discard-security              yes;
                                        discard-stream                yes;
                                        discard-unknown               yes;
                                        discard-malformed             yes;
                                    }
                                    icmp {
                                        discard-frag           yes;
                                        discard-error-messages yes;
                                        discard-large-packet   yes;
                                        discard-ping-zero-id   yes;
                                        discard-malformed      yes;
                                    }
                                }
                            }
                            dns-filtering {
                                dns-filtering-profiles TG-DNS-Filter-Block {
                                    lef-profile-default true;
                                    black-list {
                                        patterns [ .*deezer.* .*gitlab.com ];
                                        action {
                                            predefined block;
                                        }
                                    }
                                }
                            }
                            dlp {
                                dlp-profiles {
                                    dlp-profile TG-DLP-Profile {
                                        lef-profile-default      true;
                                        default-action {
                                            action alert;
                                        }
                                        exit-on-first-rule-match disabled;
                                    }
                                }
                            }
                            casb {
                                casb-profile TG-CASB-Default {
                                    default-action {
                                        predefined allow;
                                    }
                                    lef-profile-default true;
                                    rules {
                                        casb-rule TG-Reddit-Bad {
                                            activation true;
                                            match {
                                                predefined-applications {
                                                    casb-predefined-application reddit {
                                                        predefined-application-activity [ like login post upload_file ];
                                                    }
                                                }
                                            }
                                            set {
                                                action {
                                                    predefined allow;
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                            sandboxing {
                                sandbox-profile TG-ATP-Filter {
                                    lef-profile-default true;
                                    reputation {
                                        lookup  disabled;
                                        logging disabled;
                                    }
                                    sandbox-action-profile {
                                        action-profile Allow-and-Scan-First-Time {
                                            send-to-sandbox            enabled;
                                            action-for-sandbox-pending allow-and-scan-first-time;
                                            sandbox-action-on-result {
                                                clean {
                                                    action allow;
                                                }
                                                suspicious {
                                                    action alert;
                                                }
                                                malicious {
                                                    action block;
                                                }
                                            }
                                        }
                                    }
                                    rules {
                                        rules-list ATP-Rule {
                                            activation true;
                                            match {
                                                protocol  [ HTTP ];
                                                direction both;
                                                file-type [ txt ];
                                            }
                                            set {
                                                sandbox-action-profile Allow-and-Scan-First-Time;
                                            }
                                        }
                                    }
                                    default-action {
                                        action allow;
                                    }
                                }
                            }
                        }
                        captive-portal {
                            expiration-time 30;
                        }
                        access-policies {
                            access-policy-group Default-Policy {
                                rules {
                                    access-policy TG-ICMP-Allow {
                                        rule-disable false;
                                        match {
                                            source {
                                                user {
                                                    local-database {
                                                        status disabled;
                                                    }
                                                    external-database {
                                                        status disabled;
                                                    }
                                                    user-type any;
                                                }
                                            }
                                            services {
                                                predefined-services-list [ ICMP echo ];
                                            }
                                        }
                                        set {
                                            action                allow;
                                            tcp-session-keepalive disabled;
                                            lef {
                                                profile-default true;
                                                event           both;
                                                options {
                                                    send-pcap-data {
                                                        enable false;
                                                    }
                                                }
                                            }
                                            set-type              public;
                                        }
                                    }
                                    access-policy TG-DNS-Allow {
                                        description  "DNS Traffic is allowed";
                                        rule-disable false;
                                        match {
                                            source {
                                                user {
                                                    local-database {
                                                        status disabled;
                                                    }
                                                    external-database {
                                                        status disabled;
                                                    }
                                                    user-type any;
                                                }
                                            }
                                            services {
                                                predefined-services-list [ domain ];
                                            }
                                        }
                                        set {
                                            security-profile {
                                                ips {
                                                    predefined-ips-profile "Versa Recommended Profile";
                                                }
                                            }
                                            action                allow;
                                            tcp-session-keepalive disabled;
                                            lef {
                                                profile-default true;
                                                event           start;
                                                options {
                                                    send-pcap-data {
                                                        enable false;
                                                    }
                                                }
                                            }
                                        }
                                    }
                                    access-policy TG-LDAP-Allow {
                                        rule-disable false;
                                        match {
                                            source {
                                                user {
                                                    local-database {
                                                        status disabled;
                                                    }
                                                    external-database {
                                                        status disabled;
                                                    }
                                                    user-type any;
                                                }
                                            }
                                            services {
                                                predefined-services-list [ ldap ldaps ];
                                            }
                                        }
                                        set {
                                            action                allow;
                                            tcp-session-keepalive disabled;
                                            lef {
                                                profile-default true;
                                                event           both;
                                                options {
                                                    send-pcap-data {
                                                        enable false;
                                                    }
                                                }
                                            }
                                        }
                                    }
                                    access-policy TG-Run-IP-Filter-Profile {
                                        rule-disable false;
                                        match {
                                            source {
                                                user {
                                                    local-database {
                                                        status disabled;
                                                    }
                                                    external-database {
                                                        status disabled;
                                                    }
                                                    user-type any;
                                                }
                                            }
                                            destination {
                                                address {
                                                    address-group-list [ TG-Bad-Events ];
                                                }
                                            }
                                        }
                                        set {
                                            security-profile {
                                                ip-filtering {
                                                    user-defined TG-Bad-IP-Filter;
                                                }
                                            }
                                            action                allow;
                                            tcp-session-keepalive disabled;
                                            lef {
                                                profile-default true;
                                                event           both;
                                                options {
                                                    send-pcap-data {
                                                        enable false;
                                                    }
                                                }
                                            }
                                            set-type              public;
                                        }
                                    }
                                    access-policy TG-Run-DNS-Filter-Profile {
                                        rule-disable false;
                                        match {
                                            source {
                                                user {
                                                    local-database {
                                                        status disabled;
                                                    }
                                                    external-database {
                                                        status disabled;
                                                    }
                                                    user-type any;
                                                }
                                            }
                                            application {
                                                user-defined-application-list [ TG-DNS-Filter-URLS ];
                                            }
                                        }
                                        set {
                                            security-profile {
                                                dns-filtering {
                                                    user-defined TG-DNS-Filter-Block;
                                                }
                                            }
                                            action                allow;
                                            tcp-session-keepalive disabled;
                                            lef {
                                                profile-default true;
                                                event           both;
                                                options {
                                                    send-pcap-data {
                                                        enable false;
                                                    }
                                                }
                                            }
                                            set-type              public;
                                        }
                                    }
                                    access-policy TG-Run-AV-Profile {
                                        rule-disable false;
                                        match {
                                            source {
                                                user {
                                                    local-database {
                                                        status disabled;
                                                    }
                                                    external-database {
                                                        status disabled;
                                                    }
                                                    user-type any;
                                                }
                                            }
                                            application {
                                                user-defined-application-list [ TG-AntiVirus-Scan-URLS ];
                                            }
                                        }
                                        set {
                                            security-profile {
                                                antivirus {
                                                    user-defined-av-profile TG-AntiVirus-Scan-Zip-Files;
                                                }
                                            }
                                            action                allow;
                                            tcp-session-keepalive disabled;
                                            lef {
                                                profile-default true;
                                                event           both;
                                                options {
                                                    send-pcap-data {
                                                        enable false;
                                                    }
                                                }
                                            }
                                            set-type              public;
                                        }
                                    }
                                    access-policy TG-Run-File-Filter-Profile {
                                        rule-disable false;
                                        match {
                                            source {
                                                user {
                                                    local-database {
                                                        status disabled;
                                                    }
                                                    external-database {
                                                        status disabled;
                                                    }
                                                    user-type any;
                                                }
                                            }
                                            application {
                                                user-defined-application-list [ TG-File-Filter-URLS ];
                                            }
                                        }
                                        set {
                                            security-profile {
                                                file-filtering {
                                                    user-defined-file-filtering-profile TG-File-Filter-Profile;
                                                }
                                            }
                                            action                allow;
                                            tcp-session-keepalive disabled;
                                            lef {
                                                profile-default true;
                                                event           both;
                                                options {
                                                    send-pcap-data {
                                                        enable false;
                                                    }
                                                }
                                            }
                                            set-type              public;
                                        }
                                    }
                                    access-policy TG-Run-Vulnerability-Profile {
                                        rule-disable false;
                                        match {
                                            source {
                                                user {
                                                    local-database {
                                                        status disabled;
                                                    }
                                                    external-database {
                                                        status disabled;
                                                    }
                                                    user-type any;
                                                }
                                            }
                                            application {
                                                user-defined-application-list [ TG-Vulnerabilit-Predefined-URLS ];
                                            }
                                        }
                                        set {
                                            security-profile {
                                                ips {
                                                    predefined-ips-profile "All Anomaly Rules";
                                                }
                                            }
                                            action                allow;
                                            tcp-session-keepalive disabled;
                                            lef {
                                                profile-default true;
                                                event           both;
                                                options {
                                                    send-pcap-data {
                                                        enable false;
                                                    }
                                                }
                                            }
                                            set-type              public;
                                        }
                                    }
                                    access-policy TG-Run-ATP-Profile {
                                        rule-disable false;
                                        match {
                                            source {
                                                user {
                                                    local-database {
                                                        status disabled;
                                                    }
                                                    external-database {
                                                        status disabled;
                                                    }
                                                    user-type any;
                                                }
                                            }
                                            application {
                                                user-defined-application-list [ TG-ATP-Predefined-URLS ];
                                            }
                                        }
                                        set {
                                            security-profile {
                                                sandboxing {
                                                    user-defined-sandbox-profile TG-ATP-Filter;
                                                }
                                            }
                                            action                allow;
                                            tcp-session-keepalive disabled;
                                            lef {
                                                profile-default true;
                                                event           both;
                                                options {
                                                    send-pcap-data {
                                                        enable false;
                                                    }
                                                }
                                            }
                                            set-type              public;
                                        }
                                    }
                                    access-policy TG-Run-CASB-Profile {
                                        rule-disable false;
                                        match {
                                            source {
                                                user {
                                                    local-database {
                                                        status disabled;
                                                    }
                                                    external-database {
                                                        status disabled;
                                                    }
                                                    user-type any;
                                                }
                                            }
                                            application {
                                                predefined-application-list [ REDDIT ];
                                            }
                                        }
                                        set {
                                            security-profile {
                                                casb {
                                                    user-defined-casb-profile TG-CASB-Default;
                                                }
                                            }
                                            action                allow;
                                            tcp-session-keepalive disabled;
                                            lef {
                                                profile-default true;
                                                event           both;
                                                options {
                                                    send-pcap-data {
                                                        enable false;
                                                    }
                                                }
                                            }
                                            set-type              public;
                                        }
                                    }
                                    access-policy TG-Run-DLP-Profile {
                                        rule-disable true;
                                        match {
                                            source {
                                                user {
                                                    local-database {
                                                        status disabled;
                                                    }
                                                    external-database {
                                                        status disabled;
                                                    }
                                                    user-type any;
                                                }
                                            }
                                        }
                                        set {
                                            security-profile {
                                                dlp {
                                                    user-defined-dlp-profile TG-DLP-Profile;
                                                }
                                            }
                                            action                allow;
                                            tcp-session-keepalive disabled;
                                            lef {
                                                profile-default true;
                                                event           both;
                                                options {
                                                    send-pcap-data {
                                                        enable false;
                                                    }
                                                }
                                            }
                                            set-type              public;
                                        }
                                    }
                                    access-policy TG-Run-URL-Filter-Profile {
                                        rule-disable false;
                                        match {
                                            source {
                                                user {
                                                    local-database {
                                                        status disabled;
                                                    }
                                                    external-database {
                                                        status disabled;
                                                    }
                                                    user-type any;
                                                }
                                            }
                                        }
                                        set {
                                            security-profile {
                                                url-filtering {
                                                    user-defined TG-URL-Filter-Block;
                                                }
                                            }
                                            action                allow;
                                            tcp-session-keepalive disabled;
                                            lef {
                                                profile-default true;
                                                event           both;
                                                options {
                                                    send-pcap-data {
                                                        enable false;
                                                    }
                                                }
                                            }
                                            set-type              public;
                                        }
                                    }
                                    access-policy TG-QUIC {
                                        rule-disable false;
                                        match {
                                            source {
                                                user {
                                                    local-database {
                                                        status disabled;
                                                    }
                                                    external-database {
                                                        status disabled;
                                                    }
                                                    user-type any;
                                                }
                                            }
                                            services {
                                                services-list [ Quic ];
                                            }
                                        }
                                        set {
                                            action                deny;
                                            tcp-session-keepalive disabled;
                                            lef {
                                                profile-default true;
                                                event           both;
                                                options {
                                                    send-pcap-data {
                                                        enable false;
                                                    }
                                                }
                                            }
                                        }
                                    }
                                    access-policy TG-Allow-Business-App-Filters {
                                        description  "Business traffic is allowed";
                                        rule-disable false;
                                        match {
                                            source {
                                                user {
                                                    local-database {
                                                        status disabled;
                                                    }
                                                    external-database {
                                                        status disabled;
                                                    }
                                                    user-type any;
                                                }
                                            }
                                            services {
                                                predefined-services-list [ http https ];
                                            }
                                            application {
                                                predefined-filter-list [ Business-Traffic ];
                                            }
                                        }
                                        set {
                                            action                allow;
                                            tcp-session-keepalive disabled;
                                            lef {
                                                profile-default true;
                                                event           both;
                                                options {
                                                    send-pcap-data {
                                                        enable false;
                                                    }
                                                }
                                            }
                                        }
                                    }
                                    access-policy TG-Deny-Non-Business-App-Filters {
                                        description  "High-Risk,Non-Business application traffic is denied";
                                        rule-disable false;
                                        match {
                                            source {
                                                user {
                                                    local-database {
                                                        status disabled;
                                                    }
                                                    external-database {
                                                        status disabled;
                                                    }
                                                    user-type any;
                                                }
                                            }
                                            services {
                                                predefined-services-list [ http https ];
                                            }
                                            application {
                                                predefined-filter-list [ Non-Business-Traffic ];
                                            }
                                            url-reputation {
                                                predefined [ high_risk ];
                                            }
                                        }
                                        set {
                                            action                deny;
                                            tcp-session-keepalive disabled;
                                            lef {
                                                profile-default true;
                                                event           both;
                                                options {
                                                    send-pcap-data {
                                                        enable false;
                                                    }
                                                }
                                            }
                                        }
                                    }
                                    access-policy TG-Deny-High-Risk-Apps {
                                        description  "High-Risk application traffic is denied";
                                        rule-disable false;
                                        match {
                                            source {
                                                user {
                                                    local-database {
                                                        status disabled;
                                                    }
                                                    external-database {
                                                        status disabled;
                                                    }
                                                    user-type any;
                                                }
                                            }
                                            services {
                                                predefined-services-list [ http https ];
                                            }
                                            application {
                                                predefined-filter-list [ High-Risk-Applications ];
                                            }
                                        }
                                        set {
                                            action                deny;
                                            tcp-session-keepalive disabled;
                                            lef {
                                                profile-default true;
                                                event           both;
                                                options {
                                                    send-pcap-data {
                                                        enable false;
                                                    }
                                                }
                                            }
                                        }
                                    }
                                    access-policy TG-Security-Policies-Run-Profiles-Rule {
                                        rule-disable false;
                                        match {
                                            source {
                                                user {
                                                    local-database {
                                                        status disabled;
                                                    }
                                                    external-database {
                                                        status disabled;
                                                    }
                                                    user-type any;
                                                }
                                            }
                                        }
                                        set {
                                            security-profile {
                                                antivirus {
                                                    predefined-av-profile "Scan Web and Email Traffic";
                                                }
                                                dns-filtering {
                                                    user-defined TG-DNS-Filter-Block;
                                                }
                                                ips {
                                                    predefined-ips-profile "All Anomaly Rules";
                                                }
                                                ip-filtering {
                                                    user-defined TG-Bad-IP-Filter;
                                                }
                                                file-filtering {
                                                    user-defined-file-filtering-profile TG-File-Filter-Profile;
                                                }
                                                url-filtering {
                                                    user-defined TG-URL-Filter-Block;
                                                }
                                                casb {
                                                    user-defined-casb-profile TG-CASB-Default;
                                                }
                                                sandboxing {
                                                    user-defined-sandbox-profile TG-ATP-Filter;
                                                }
                                            }
                                            action                allow;
                                            tcp-session-keepalive disabled;
                                            lef {
                                                profile-default true;
                                                event           both;
                                                options {
                                                    send-pcap-data {
                                                        enable false;
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                        authentication-policies {
                            authentication-group Default-Policy;
                        }
                        dos-policies {
                            dos-policy-group DoS-Policy {
                                rules {
                                    dos-policy Dos-rule {
                                        rule-disable false;
                                        set {
                                            action protect;
                                            lef {
                                                profile-default true;
                                            }
                                            dos-profile {
                                                aggregate  Aggregate-Prof;
                                                classified Classified-Prof;
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                    objects {
                        addresses {
                            address TG-Bad-Address-1 {
                                ipv4-prefix 2.56.58.85/32;
                            }
                            address TG-Bad-Address-2 {
                                ipv4-prefix 43.131.61.151/32;
                            }
                            address TG-Bad-Address-3 {
                                ipv4-prefix 210.140.43.55/32;
                            }
                            address TG-Bad-Address-4 {
                                ipv4-prefix 15.204.168.1/32;
                            }
                            address TG-Bad-Address-5 {
                                ipv4-prefix 43.163.198.174/32;
                            }
                            address TG-Bad-Address-6 {
                                ipv4-prefix 45.116.226.138/32;
                            }
                            address TG-Bad-Address-7 {
                                ipv4-prefix 43.134.111.101/32;
                            }
                            address TG-Bad-Address-8 {
                                ipv4-prefix 94.205.22.95/32;
                            }
                            address TG-Bad-Address-9 {
                                ipv4-prefix 2.56.58.88/32;
                            }
                            address TG-Bad-Address-10 {
                                ipv4-prefix 45.116.226.137/32;
                            }
                            address TG-Bad-Address-11 {
                                ipv4-prefix 43.153.135.112/32;
                            }
                            address TG-Bad-Address-12 {
                                ipv4-prefix 157.245.201.168/32;
                            }
                            address TG-Bad-Address-13 {
                                ipv4-prefix 103.48.139.139/32;
                            }
                            address TG-Bad-Address-14 {
                                ipv4-prefix 193.42.33.70/32;
                            }
                            address TG-Bad-Address-15 {
                                ipv4-prefix 119.41.206.123/32;
                            }
                            address TG-Bad-Address-16 {
                                ipv4-prefix 163.123.143.173/32;
                            }
                            address TG-Bad-Address-17 {
                                ipv4-prefix 223.73.35.54/32;
                            }
                            address TG-Bad-Address-18 {
                                ipv4-prefix 45.116.226.134/32;
                            }
                            address TG-Bad-Address-19 {
                                ipv4-prefix 2.56.58.93/32;
                            }
                            address TG-Bad-Address-20 {
                                ipv4-prefix 103.43.140.104/32;
                            }
                            address TG-Bad-Address-21 {
                                ipv4-prefix 2.56.58.81/32;
                            }
                            address TG-Bad-Address-22 {
                                ipv4-prefix 219.117.221.11/32;
                            }
                            address TG-Bad-Address-23 {
                                ipv4-prefix 45.116.226.132/32;
                            }
                            address TG-Bad-Address-24 {
                                ipv4-prefix 103.240.252.59/32;
                            }
                            address TG-Bad-Address-25 {
                                ipv4-prefix 45.117.140.211/32;
                            }
                            address TG-Bad-Address-26 {
                                ipv4-prefix 103.48.139.91/32;
                            }
                            address TG-Bad-Address-27 {
                                ipv4-prefix 117.50.198.181/32;
                            }
                            address TG-Bad-Address-28 {
                                ipv4-prefix 58.96.82.68/32;
                            }
                        }
                        address-groups {
                            group TG-Bad-Events {
                                address-list [ TG-Bad-Address-1 TG-Bad-Address-2 TG-Bad-Address-3 TG-Bad-Address-4 TG-Bad-Address-5 TG-Bad-Address-6 TG-Bad-Address-7 TG-Bad-Address-8 TG-Bad-Address-9 TG-Bad-Address-10 TG-Bad-Address-11 TG-Bad-Address-12 TG-Bad-Address-13 TG-Bad-Address-14 TG-Bad-Address-15 TG-Bad-Address-16 TG-Bad-Address-17 TG-Bad-Address-18 TG-Bad-Address-19 TG-Bad-Address-20 TG-Bad-Address-21 TG-Bad-Address-22 TG-Bad-Address-23 TG-Bad-Address-24 TG-Bad-Address-25 TG-Bad-Address-26 TG-Bad-Address-27 TG-Bad-Address-28 ];
                                type         static;
                            }
                        }
                        zones {
                            zone Intf-l1-Zone;
                        }
                        services {
                            service Quic {
                                protocol         UDP;
                                destination-port 80,443;
                            }
                        }
                        snat {
                            pool TG-PROXY-DNS {
                                routing-instance Skechers-Demo-Enterprise;
                            }
                        }
                        cloud-profile {
                            sslcloud-profile TG-Reversing-Labs-Cloud-Profile {
                                activation      enabled;
                                connection-pool 100;
                                timeout         120;
                                type {
                                    custom-param {
                                        default-config enabled;
                                    }
                                }
                                snat-pool       TG-PROXY-DNS;
                                snat-list       [ TG-PROXY-DNS ];
                            }
                        }
                    }
                }
            }
            /* Tags: replace */
            service-node-groups {
                service-node-group default-sng {
                    id       0;
                    type     internal;
                    services [ stateful-firewall ];
                }
            }
            system {
                /* Tags: replace */
                sd-wan;
            }
        }
    }
}
